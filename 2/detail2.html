<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Project Detail</title>
<link rel="icon" type="image/png" href="/alfoze/images/fav.png" />
<meta name="theme-color" content="#ffffff" />
<style>
  @import url("https://use.typekit.net/zuk4pzv.css");
  * { box-sizing:border-box; margin:0; padding:0; }
  body { font-family:"minion-pro", serif; background:#fff; }
  a { color:inherit; text-decoration:none; transition:color .3s; }
  a:hover { color:#a3a3a3; }

  .footer { position:fixed; bottom:0; width:100%; height:100px; background:transparent; z-index:1000; }
  .footer .right-link { position:absolute; bottom:10px; left:30px; font-size:12px; }
  .footer #listButton { position:absolute; bottom:10px; right:30px; font-size:12px; cursor:pointer; }
  .footer #listButton:hover { color:#7a7a7a; }

  .slide-box { position:fixed; top:0; right:0; width:373px; max-width:100%; height:100%; background:#fff; transform:translateX(100%); transition: transform .3s; overflow-y:auto; padding:10px; z-index:3000; }
  .slide-box.active { transform:translateX(0); }
  .slide-box .slide-list { position:absolute; bottom:10px; right:30px; font-size:12px; cursor:pointer; z-index:4001; color:#a3a3a3; }
  .slide-box .slide-list:hover { color:#7a7a7a; }

  .caption-group { display:flex; flex-direction:column; font-size:12px; }
  .caption1 { font-size:20px; margin-bottom:3px; }
  .caption2 { font-size:12px; margin-bottom:20px; }
  .caption3, .caption4, .caption5 { font-size:12px; margin-bottom:3px; }

  .fixed-image img { width:100%; height:auto; cursor:pointer; display:block; margin-bottom:8px; }

  .image-viewer { position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; opacity:0; visibility:hidden; transition:opacity .3s; z-index:5000; }
  .image-viewer.active { opacity:1; visibility:visible; }
  .image-viewer img { max-width:90%; max-height:90%; object-fit:contain; box-shadow:0 0 20px rgba(0,0,0,0.5); }
  .image-viewer::after { content:'×'; position:fixed; top:20px; right:30px; font-size:28px; color:#fff; cursor:pointer; font-family:sans-serif; }
</style>
</head>
<body>
<div class="gallery-wrap">
  <div class="fixed-image" id="fixedImageContainer"></div>

  <div class="slide-box" id="slideBox">
    <div class="slide-list" id="slideToggleText" onclick="toggleSlideBox()">list</div>
    <div class="caption-group" id="captionBox"></div>
  </div>
</div>

<div class="footer">
  <div class="right-link"><a href="/alfoze/">back</a></div>
  <div id="listButton" onclick="toggleSlideBox()">list</div>
</div>

<div class="image-viewer" id="imageViewer">
  <img src="" alt="viewer image" />
</div>

<script>
async function loadData() {
  const res = await fetch("../data.json");
  const data = await res.json();
  const pathParts = window.location.pathname.split("/");
  const idx = parseInt(pathParts[pathParts.length-2],10);
  const item = data[idx-1];
  if(!item) return;

  const fixedImageContainer = document.getElementById("fixedImageContainer");
  fixedImageContainer.innerHTML = "";
  item.images.forEach(src => {
    const img = document.createElement("img");
    img.src = src;
    fixedImageContainer.appendChild(img);
  });

  const captionBox = document.getElementById("captionBox");
  captionBox.innerHTML = `
    <div class="caption1">${item.captions.caption1}</div>
    <div class="caption2">${item.captions.caption2}</div>
    <div class="caption3">${item.captions.caption3}</div>
    <div class="caption4">${item.captions.caption4}</div>
    <div class="caption5">${item.captions.caption5}</div>
  `;

  // 이미지 뷰어
  const viewer = document.getElementById("imageViewer");
  const viewerImg = viewer.querySelector("img");
  document.querySelectorAll(".fixed-image img").forEach(img => {
    img.addEventListener("click", () => {
      viewerImg.src = img.src;
      viewer.classList.add("active");
    });
  });
  viewer.addEventListener("click", ()=>viewer.classList.remove("active"));
  document.addEventListener("keydown", e=>{ if(e.key==="Escape") viewer.classList.remove("active"); });
}

function toggleSlideBox() {
  const sb = document.getElementById("slideBox");
  const txt = document.getElementById("slideToggleText");
  sb.classList.toggle("active");
  txt.textContent = sb.classList.contains("active") ? "close" : "list";
  document.getElementById("listButton").textContent = txt.textContent;
}

document.addEventListener("DOMContentLoaded", loadData);
</script>
</body>
</html>
