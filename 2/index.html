<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>상세페이지</title>
  <link rel="icon" type="image/png" href="/test/images/fav2.png" />
  <link rel="apple-touch-icon" href="/test/images/fav1.png" />
  <meta name="theme-color" content="#ffffff" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: "minion-pro", serif; background: #fff; }
    a { color: inherit; text-decoration: none; }
    a:hover { color: #a3a3a3; }

    .gallery-wrap { display: flex; flex-direction: column; }
    .fixed-image img { width: 100%; height: auto; margin-bottom: 8px; cursor: pointer; }
    .caption-group { font-size: 12px; margin: 10px; }
    .caption1 { font-size: 20px; margin-bottom: 3px; }
    .caption2, .caption3, .caption4, .caption5 { margin-bottom: 3px; }

    .footer { width: 100%; height: 100px; background: transparent; position: fixed; bottom:0; left:0; }
    .footer .right-link, .footer #listButton { position: absolute; bottom: 10px; font-size: 12px; }
    .footer .right-link { left: 30px; }
    .footer #listButton { right: 30px; cursor: pointer; }

    .image-viewer { position: fixed; top:0; left:0; width:100vw; height:100vh; background: rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; opacity:0; visibility:hidden; transition: opacity .3s ease; z-index:5000; }
    .image-viewer.active { opacity:1; visibility:visible; }
    .image-viewer img { max-width:90%; max-height:90%; object-fit:contain; }
    .image-viewer::after { content: '×'; position: fixed; top:20px; right:30px; font-size:28px; color:#fff; cursor:pointer; }

    @media(max-width:768px){ .fixed-image img{width:100%;height:auto;} }
  </style>
</head>
<body>
  <div class="gallery-wrap">
    <div class="fixed-image" id="fixedImageContainer"></div>
    <div class="caption-group" id="captionBox"></div>
  </div>

  <div class="footer">
    <div class="right-link"><a href="../">back</a></div>
    <div id="listButton" onclick="toggleSlideBox()">list</div>
  </div>

  <div class="image-viewer" id="imageViewer"><img src="" alt="viewer image" /></div>

  <script>
    async function loadData() {
      const res = await fetch("../data.json");
      const data = await res.json();

      const pathParts = window.location.pathname.split("/");
      const idx = parseInt(pathParts[pathParts.length-2], 10);
      const item = data[idx-1];
      if(!item) return;

      const fixedImageContainer = document.getElementById("fixedImageContainer");
      fixedImageContainer.innerHTML = "";
      item.images.forEach(src => {
        const img = document.createElement("img");
        img.src = src;
        img.alt = item.title;
        fixedImageContainer.appendChild(img);
      });

      const captionBox = document.getElementById("captionBox");
      captionBox.innerHTML = `
        <div class="caption1">${item.title}</div>
        <div class="caption2">${item.year}, ${item.category}</div>
        <div class="caption3">${item.caption3 || ""}</div>
        <div class="caption4">${item.caption4 || ""}</div>
        <div class="caption5">${item.caption5 || ""}</div>
      `;

      const viewer = document.getElementById("imageViewer");
      const viewerImg = viewer.querySelector("img");
      fixedImageContainer.querySelectorAll("img").forEach(img => {
        img.addEventListener("click", () => {
          viewerImg.src = img.src;
          viewer.classList.add("active");
        });
      });
      viewer.addEventListener("click", () => viewer.classList.remove("active"));
      document.addEventListener("keydown", e => { if(e.key==="Escape") viewer.classList.remove("active"); });
    }

    function toggleSlideBox() { /* 모바일에서 슬라이드 토글용 */ }

    document.addEventListener("DOMContentLoaded", loadData);
  </script>
</body>
</html>
